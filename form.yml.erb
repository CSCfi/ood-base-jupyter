<% require "/ood/deps/util/attributes/csc_smart_attributes" -%>

# Batch Connect app configuration file
#
# @note Used to define the submitted cluster, title, description, and
#   hard-coded/user-defined attributes that make up this Batch Connect app.
---

# **MUST** set cluster id here that matches cluster configuration file located
# under /etc/ood/config/clusters.d/*.yml
# @example Use the Owens cluster at Ohio Supercomputer Center
#     cluster: "owens"
cluster: "puhti"

# Define attribute values that aren't meant to be modified by the user within
# the Dashboard form
attributes:
  # Set the corresponding modules that need to be loaded for Jupyter to run
  #
  # @note It is called within the batch job as `module load <modules>` if
  #   defined
  # @example Do not load any modules
  #     modules: ""
  # @example Using default python module
  #     modules: "python"
  # @example Using specific python module
  #     modules: "python/3.5"
  # @example Using combination of modules
  #     modules: "python/3.5 cuda/8.0.44"
  #modules: "python-env/2019.3"
  #bc_queue: "test" 

  # Any extra command line arguments to feed to the `jupyter notebook ...`
  # command that launches the Jupyter notebook within the batch job
  extra_jupyter_args:
      value: ""

  csc_slurm_partition:
    value: "interactive"
    select:
      - "interactive"
      - "small"
      - "gpu"
      - "test"
    help: |
      Selecting gpu partition will reserve 1 GPU (V100)
  modules:
      label: Python
      widget: select
      options:
          - ["python-data"]
          - ["geoconda"]
          - ["python-env"]
          - ["pytorch"]
          - ["tensorflow"]
  jp_type:
      widget: select
      label: "Jupyter type"
      options:
        - ["Notebook","notebook"]
        - ["Lab","lab"]    
      value: "notebook"
      cacheable: false
      help: |
        `python-data`, `pytorch` and `tensorflow` only support Notebook
  notebook_dir:
    label: "Working directory"
    widget: select
    value: "/projappl"
    options:
      - "<%= ENV["HOME"] -%>"
      - "/projappl"
      - "/scratch"
      - "/"

form:
  - csc_slurm_project
  - csc_slurm_partition
  - csc_header_resources
  - csc_cores
  - csc_memory
  - csc_nvme
  - csc_time
  - csc_header_settings
  - modules
  - jp_type
  - notebook_dir
  - extra_jupyter_args
  - csc_slurm_limits
